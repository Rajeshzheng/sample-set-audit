<!DOCTYPE html>
<html lang="zh">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Setup - Apps Script Code</title>
<style>
body { background: #0c0b10; color: #ece9e4; font-family: system-ui, sans-serif; padding: 20px; max-width: 600px; margin: 0 auto; }
h2 { color: #e8a848; font-size: 18px; }
.step { background: #14131a; border: 1px solid #2a293a; border-radius: 10px; padding: 16px; margin: 16px 0; }
.step-num { color: #2dd4bf; font-weight: 700; }
pre { background: #1c1b24; padding: 12px; border-radius: 8px; font-size: 12px; overflow-x: auto; white-space: pre-wrap; word-break: break-all; }
button { background: #e8a848; color: #000; border: none; padding: 14px 28px; border-radius: 8px; font-size: 16px; font-weight: 700; width: 100%; cursor: pointer; margin: 10px 0; }
button.copied { background: #34d399; }
.note { color: #7a7888; font-size: 13px; margin-top: 8px; }
</style>
</head>
<body>

<h2>Apps Script 一键复制</h2>

<div class="step">
  <p><span class="step-num">Step 1</span> 点下面按钮复制代码</p>
  <button id="copyBtn" onclick="copyCode()">复制代码到剪贴板</button>
  <pre id="code">function doPost(e) {
  var s = SpreadsheetApp.getActiveSpreadsheet().getSheetByName('raw_log');
  var d = JSON.parse(e.postData.contents);
  var v = ['Aastha','Avneet','Udit Chauhan','Bobby','Maria'];
  if (v.indexOf(d.name) === -1) return ContentService.createTextOutput('err');
  s.appendRow([new Date(), d.name, d.group, d.batch, d.completed, d.total, d.type, d.timestamp, d.tool_version]);
  return ContentService.createTextOutput('ok');
}
function doGet() { return ContentService.createTextOutput('running'); }</pre>
</div>

<div class="step">
  <p><span class="step-num">Step 2</span> 打开 Google Sheets</p>
  <p>新建一个表格，把 Sheet1 底部 tab 名改为 <b>raw_log</b></p>
</div>

<div class="step">
  <p><span class="step-num">Step 3</span> 打开 Apps Script</p>
  <p>点菜单 <b>Extensions → Apps Script</b></p>
  <p>删掉默认代码，<b>粘贴</b>刚才复制的代码</p>
</div>

<div class="step">
  <p><span class="step-num">Step 4</span> 部署</p>
  <p>点右上 <b>Deploy → New deployment</b></p>
  <p>类型选 <b>Web app</b></p>
  <p>Execute as: <b>Me</b></p>
  <p>Who has access: <b>Anyone</b></p>
  <p>点 <b>Deploy</b>，复制生成的 URL 发给我</p>
</div>

<div class="note">
  ⚠️ 首次部署会要求授权，点 "Review Permissions" → 选你的账号 → "Advanced" → "Go to (unsafe)" → "Allow"
</div>

<script>
function copyCode() {
  var text = document.getElementById('code').textContent;
  navigator.clipboard.writeText(text).then(function() {
    var btn = document.getElementById('copyBtn');
    btn.textContent = '已复制 ✓';
    btn.className = 'copied';
    setTimeout(function() { btn.textContent = '复制代码到剪贴板'; btn.className = ''; }, 3000);
  });
}
</script>

</body>
</html>
